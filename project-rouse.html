<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolio</title>
    <script></script>
    <link rel="stylesheet" href="main.css">
</head>
<body>
    <img class="bg-image" src="assets/img/tram_bg.jpg" alt="">
    <img class="bg-overlay" src="assets/img/BG_Rectangles.png" alt="">
    <div class="wrapper">
        <a class="return-top" onclick="topFunction()">
            <img src="assets/icons/return-top-icon-2.png" alt="" style="height: 45px;" class="return-icon">
        </a>
        <!-- Nav bar-->
        <div class="header" style="margin-bottom: 2rem;">
            <a class="header-logo" href="index.html">
                <div class="title">
                    João Freire
                </div>
                <div class="subtitle">
                    Programmer
                    <div class="title-line"></div>
                </div>
            </a>
            <ul class="menu">
                <li>
                    <a class="menu-button" href="projects.html">
                        <div class="content">Portfolio</div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="index.html#about">
                        <div class="content">About</div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="https://www.joaofreire.se/joao_freire_cv.pdf" target="_blank">
                        <div class="content">CV</div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="https://github.com/jsfoao" target="_blank">
                        <div class="image">
                            <img src="assets/icons/github_logo.png" style="height: 100%;" alt="">
                        </div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="https://www.linkedin.com/in/joao-saraivafreire/" target="_blank">
                        <div class="image">
                            <img src="assets/icons/linkedin_logo.png" style="height: 100%;" alt="">
                        </div>
                    </a>
                </li>
                <li>
                    <a class="menu-button" href="https://jwow.itch.io/" target="_blank">
                        <div class="image">
                            <img src="assets/icons/itch-icon.png" style="height: 100%;" alt="">
                        </div>
                    </a>
                </li>
            </ul>
        </div>

        <!-- CONTENT-->
        <a href="projects.html" class="back-button">
            <img src="assets/icons/back-arrow-icon.png" alt="" class="arrow-icon-back">
            Back
        </a>
        <div class="project-title-card">
            <div class="gradient-overlay" style="opacity: 0.8"></div>
            <img class="project-title-img" src="assets/img/projects/rouse/rouse-thumbnail.png" alt="" style="bottom: -50%;">
            <div class="project-title-wrapper">
                <div class="project-title">
                    Rouse
                </div>
                <div class="category-nav-wrapper">
                    <ul class="category-list">
                        <li><div class="card-category">Game</div></li>
                        <li><div class="card-category">Unreal</div></li>
                    </ul>
                    <ul class="project-menu">
                        <li>
                            <a class="menu-button" href="https://futuregames.itch.io/rouse" target="_blank">
                                <div style="display: flex; flex-direction: row; flex-wrap: nowrap; justify-content: center; min-width: 115px; transform: translateX(3px) translateY(3px);">
                                    <div class="image">
                                        <img src="assets/icons/arrow-down.png" style="height:16px; transform: translateY(3px) translateX(-2px);" alt="">
                                    </div>
                                    <div class="content" style="font-size: medium;">
                                        Latest Build
                                    </div>
                                </div>
                            </a>
                        </li>
                        <li>
                            <a class="menu-button" href="https://github.com/jsfoao/Rouse-Personal" target="_blank">
                                <div class="image">
                                    <img src="assets/icons/github_logo.png" style="height: 120%;" alt="">
                                </div>
                            </a>
                        </li>
                        <li>
                            <a class="menu-button" href="https://futuregames.itch.io/rouse" target="_blank">
                                <div class="image">
                                    <img src="assets/icons/itch-icon.png" style="height: 120%;" alt="">
                                </div>
                            </a>
                        </li>
                    </ul>   
                </div>
            </div>
        </div>
        <div class="project-category-wrapper">
            <div class="flex-column" style="gap: 2rem; margin-top: rem; margin-bottom: 2rem;">
                <iframe width="100%" height="315" src="https://www.youtube.com/embed/_WCyCWfKtFo" style="margin-right: 2rem;" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
                <div style="max-width: 250px;">
                    <div class="category-title-big">
                        Info
                    </div>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Role:</span> 
                            Gameplay, Animation & UI Programmer
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Genre:</span> 
                            Third Person Puzzle Shooter
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Engine:</span> 
                            Unreal Engine
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Team Size:</span> 
                            12
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Platform:</span> 
                            PC
                    </p>
                    <p class="content-paragraph">
                        <span class="content-paragraph" style="font-family: Poppins SemiBold;">
                            Time:</span> 
                            7 weeks
                    </p>
                </div>
            </div>
            <div>
                <div class="category-title-big">
                    About
                </div>
                <p class="content-paragraph">
                    Rouse is a 3rd-person physics-based puzzle platformer. You play as Rose who finds herself trapped inside the dream of her little brother. 
                    The game's main mechanic is a gun that the player can use to shoot and physically affect elements in the map (freezing, inverting gravity or levitating and sticking).   
                </p>
                <div class="category-title-small">
                    Highlights
                </div>
                <div class="flex-column">
                    <ul class="bullet-point">
                        <li class="bullet-li">
                            Third person aiming and physics based shooting with projectile trajectory. 
                        </li>
                        <li class="bullet-li">
                            Object grabbing and dragging.
                        </li>
                        <li class="bullet-li">
                            System for puzzles.
                        </li>
                        <li class="bullet-li">
                            Procedural animations using IK.
                        </li>
                    </ul>
                </div>
            </div>
        </div>
        <div class="project-category-wrapper">
            <div class="category-title-big">
                Aiming and Shooting
            </div>
            <p class="content-paragraph">

            </p>
            <div class="category-title-small">
                Trajectory
            </div>
            <p class="content-paragraph">
                The projectile will always land where the player is aiming. The max height a projectile will reach (H) is the only variable
                that can be tweaked in this system where R is the distance to the point that's being aimed at. If we solve the following system of equations
                for Initial Velocity (v0) and Initial Angle (ϴ), we'll know the necessary impulse and direction to exert on the projectile to reach the point
                that is being aimed. I made this solver into a blueprint function library so that we could easily prototype it in BP aswell.
            </p>
            <div class="flex-column">
                <img src="assets/img/projects/rouse/ProjectTileTrajectory_Math.png" alt="" class="img-wrapper">
                <img src="assets/img/projects/rouse/ProjectileTrajectorySolver.gif" alt="" class="img-wrapper">    
            </div>
            <table>
                <tr>
                    <th>Property:</th>
                    <th>Function:</th>
                </tr>
                <tr>
                    <td>Height (H)</td>
                    <td>Projectile's max. height</td>
                </tr>
                <tr>
                    <td>Distance (R)</td>
                    <td>Distance from projectile origin (gun) to aimed point</td>
                </tr>
                <tr>
                    <td>Initial Angle (ϴ)</td>
                    <td>Necessary initial angle to reach aimed point</td>
                </tr>
                <tr>
                    <td>Initial Velocity (v0)</td>
                    <td>Necessary impulse to reach aimed point</td>
                </tr>
            </table>
            <div class="expandable-button">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Trajectory Solver</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">
<!-- HTML generated using hilite.me --><div class="code-snippet" style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #f8f8f2">UCLASS()</span>
    <span style="color: #66d9ef">class</span> <span style="color: #a6e22e">GP3_API</span> <span style="color: #f8f8f2">UT7PhysicsBlueprintLibrary</span> <span style="color: #f8f8f2">:</span> <span style="color: #66d9ef">public</span> <span style="color: #f8f8f2">UBlueprintFunctionLibrary</span>
    <span style="color: #f8f8f2">{</span>
        <span style="color: #f8f8f2">GENERATED_BODY()</span>
    
    <span style="color: #66d9ef">public</span><span style="color: #f8f8f2">:</span>
        <span style="color: #f8f8f2">UFUNCTION(BlueprintCallable,</span> <span style="color: #f8f8f2">Category=</span><span style="color: #e6db74">&quot;Projectiles&quot;</span><span style="color: #f8f8f2">)</span>
        <span style="color: #66d9ef">static</span> <span style="color: #66d9ef">float</span> <span style="color: #a6e22e">GetAngleRadians</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">Range,</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">MaxHeight,</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">Gravity</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">980.f</span><span style="color: #f8f8f2">)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #66d9ef">return</span> <span style="color: #a6e22e">atan</span><span style="color: #f8f8f2">((</span><span style="color: #ae81ff">4</span><span style="color: #f8f8f2">*MaxHeight)/Range);</span>
        <span style="color: #f8f8f2">}</span>
    
        <span style="color: #f8f8f2">UFUNCTION(BlueprintCallable,</span> <span style="color: #f8f8f2">BlueprintPure,</span> <span style="color: #f8f8f2">Category=</span><span style="color: #e6db74">&quot;Projectiles&quot;</span><span style="color: #f8f8f2">)</span>
        <span style="color: #66d9ef">static</span> <span style="color: #66d9ef">float</span> <span style="color: #a6e22e">GetAngleDegrees</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">Range,</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">MaxHeight,</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">Gravity</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">980.f</span><span style="color: #f8f8f2">)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #66d9ef">return</span> <span style="color: #a6e22e">atan</span><span style="color: #f8f8f2">((</span><span style="color: #ae81ff">4</span><span style="color: #f8f8f2">*MaxHeight)/Range)</span> <span style="color: #f8f8f2">*</span> <span style="color: #ae81ff">180</span><span style="color: #f8f8f2">/PI;</span>
        <span style="color: #f8f8f2">}</span>
    
        <span style="color: #f8f8f2">UFUNCTION(BlueprintCallable,</span> <span style="color: #f8f8f2">BlueprintPure,</span> <span style="color: #f8f8f2">Category=</span><span style="color: #e6db74">&quot;Projectiles&quot;</span><span style="color: #f8f8f2">)</span>
        <span style="color: #66d9ef">static</span> <span style="color: #66d9ef">float</span> <span style="color: #a6e22e">GetImpulseFromRadians</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">const</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">MaxHeight,</span> <span style="color: #66d9ef">const</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">AngleRadians,</span> <span style="color: #66d9ef">const</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">Gravity</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">980.f</span><span style="color: #f8f8f2">)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #66d9ef">return</span> <span style="color: #a6e22e">sqrtf</span><span style="color: #f8f8f2">((</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">*Gravity*MaxHeight)/sqr(sinf(AngleRadians)));</span>
        <span style="color: #f8f8f2">}</span>
    
        <span style="color: #f8f8f2">UFUNCTION(BlueprintCallable,</span> <span style="color: #f8f8f2">BlueprintPure,</span> <span style="color: #f8f8f2">Category=</span><span style="color: #e6db74">&quot;Projectiles&quot;</span><span style="color: #f8f8f2">)</span>
        <span style="color: #66d9ef">static</span> <span style="color: #66d9ef">float</span> <span style="color: #a6e22e">GetImpulseFromDegrees</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">const</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">MaxHeight,</span> <span style="color: #66d9ef">const</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">AngleDegrees,</span> <span style="color: #66d9ef">const</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">Gravity</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">980.f</span><span style="color: #f8f8f2">)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #66d9ef">return</span> <span style="color: #a6e22e">sqrtf</span><span style="color: #f8f8f2">((</span><span style="color: #ae81ff">2</span><span style="color: #f8f8f2">*Gravity*MaxHeight)/sqr(sinf(AngleDegrees*(PI/</span><span style="color: #ae81ff">180.f</span><span style="color: #f8f8f2">))));</span>
        <span style="color: #f8f8f2">}</span>
    
        <span style="color: #f8f8f2">UFUNCTION(BlueprintCallable,</span> <span style="color: #f8f8f2">BlueprintPure,</span> <span style="color: #f8f8f2">Category=</span><span style="color: #e6db74">&quot;Projectiles&quot;</span><span style="color: #f8f8f2">)</span>
        <span style="color: #66d9ef">static</span> <span style="color: #f8f8f2">FVector</span> <span style="color: #a6e22e">GetAdjustedGravity</span><span style="color: #f8f8f2">(</span><span style="color: #66d9ef">const</span> <span style="color: #f8f8f2">FVector</span> <span style="color: #f8f8f2">AimUpVector,</span> <span style="color: #66d9ef">const</span> <span style="color: #66d9ef">float</span> <span style="color: #f8f8f2">Gravity</span> <span style="color: #f8f8f2">=</span> <span style="color: #ae81ff">980.f</span><span style="color: #f8f8f2">)</span>
        <span style="color: #f8f8f2">{</span>
            <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">-AimUpVector</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">Gravity;</span>
        <span style="color: #f8f8f2">}</span>
    <span style="color: #f8f8f2">};</span>
    </pre></div>
    

                </div>
            <div class="category-title-small">
                Animation
            </div>
            <div>
                <p style="margin-bottom: 0;">
                    Since we didn't have an animator on the team, we adapted by recurring to mostly procedural animation and using IK.
                    <ul class="bullet-point">
                        <li class="bullet-li">
                            The character's upper body will yaw to face the aimed point. It will also pitch to match the initial angle that the projectile is being shot at.
                        </li>
                        <li class="bullet-li">
                            The character's bones are individually translated and rotated to simulate recoil.
                        </li>
                        <li class="bullet-li">
                            The character will also move its body (both lower and upper) depending on the speed that camera is being turned.
                        </li>
                    </ul>
                </p>
            </div>
            <div class="flex-column">
                <img src="assets/img/projects/rouse/HorizontalAnim.gif" alt="" class="img-wrapper">
                <img src="assets/img/projects/rouse/Left hand placement.gif" alt="" class="img-wrapper">
                <img src="assets/img/projects/rouse/turninplace.gif" alt="" class="img-wrapper">
            </div>
            <div class="expandable-button" style="margin-top: 1rem;">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Aim Pitch</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">
                    <iframe class="code-snippet" style="width:95%; height: 600px;" src="https://blueprintue.com/render/bcgwbmc4/" scrolling="no" allowfullscreen></iframe>
                </div>
            </div>   
            <div class="category-title-small">
                UI
            </div>
            <p class="content-paragraph">
                <ul class="bullet-point">
                    <li class="bullet-li">
                        Dynamic crosshair that will sync to the gun's firerate. Crosshair will play a rotation animation when aim target is in range but will be static  and lower its opacity if target is not in range.
                    </li>
                    <li class="bullet-li">
                        When pointing at an interactable that is affected by a power, a circle will show that will be filled on player retract.
                    </li>
                    <li>
                        Gameboy shows color of selected power and its corresponding ammo amount in world space.
                    </li>
                    <li>
                        Some more animations and visal cues are used to communicate when a retract is done or when shooting with no ammo.
                    </li>
                </ul>
            </p>
            <div class="flex-column">
                <img src="assets/img/projects/rouse/CrosshairAnimation.gif" alt="" class="img-wrapper">
                <img src="assets/img/projects/rouse/gameboyui.gif" alt="" class="img-wrapper">
            </div>
            </div>
        </div> 
        <div class="project-category-wrapper">
            <div class="category-title-big">
                Grabbing & Dragging
            </div>
            <div class="content-paragraph">
                <p> 
                    The behaviour for this mechanic is mostly inspired by Little Nightmares' dragging system where the player needs to interact with an object to grab it
                    and only then can drag it around. The object will be dropped if that same button is pressed or if it goes out of range.
                </p>     
                <p>
                    Two actor components are used on this system. One on the object that can be pushed and another one on the entity that can push objects.
                    This pattern allows for a modular system where new objects could be very easily added and be pushed around by the existing or new characters.
                </p>
                <a class="external-link" href="https://www.youtube.com/watch?v=j2rqnZJ1T_0" target="_blank">
                    <img src="assets/icons/external_link.png" alt="" class="arrow-icon-back">
                    Little Nightmares' Drag System
                </a>
            </div>
            <div class="flex-column">
                <img src="assets/img/projects/rouse/PushingDragging.gif" alt="" class="img-wrapper">
                <img src="assets/img/projects/rouse/Pushable_Properties.png" alt="" class="img-wrapper">
            </div>
            <div class="expandable-button" style="margin-top: 1rem;">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Push Component</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">    
                    <!-- HTML generated using hilite.me --><div class="code-snippet" style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">void</span> <span style="color: #f8f8f2">UT7PushComponent::TryPush(AActor*</span> <span style="color: #f8f8f2">ActorToPush)</span>
<span style="color: #f8f8f2">{</span>
	<span style="color: #75715e">// Not interacting with valid actor</span>
	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(ActorToPush</span> <span style="color: #f8f8f2">==</span> <span style="color: #f8f8f2">nullptr)</span> <span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span>
	<span style="color: #f8f8f2">UT7PushableComponent*</span> <span style="color: #f8f8f2">PushableComp</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">ActorToPush-&gt;FindComponentByClass&lt;UT7PushableComponent&gt;();</span>
	<span style="color: #75715e">// Actor isn&#39;t pushable</span>
	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(PushableComp</span> <span style="color: #f8f8f2">==</span> <span style="color: #f8f8f2">nullptr)</span> <span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span>
	
	<span style="color: #f8f8f2">Pushable</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">PushableComp;</span>
	<span style="color: #75715e">// Check if pushable is grounded</span>
	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(!Pushable-&gt;bIsGrounded)</span>
	<span style="color: #f8f8f2">{</span>
		<span style="color: #f8f8f2">LOG(</span><span style="color: #e6db74">&quot;Can&#39;t push, object isn&#39;t grounded...&quot;</span><span style="color: #f8f8f2">);</span>
		<span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span>
	<span style="color: #f8f8f2">}</span>
	<span style="color: #75715e">// Evaluate which side is being pushed</span>
	<span style="color: #f8f8f2">bIsOverlapping</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Pushable-&gt;EvaluateOverlap(GetOwner());</span>
	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(!bIsOverlapping)</span>
	<span style="color: #f8f8f2">{</span>
		<span style="color: #f8f8f2">LOG(</span><span style="color: #e6db74">&quot;Can&#39;t push, not overlapping pushable...&quot;</span><span style="color: #f8f8f2">)</span>
		<span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span>
	<span style="color: #f8f8f2">}</span>
	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(!Pushable-&gt;bCanPush)</span>
	<span style="color: #f8f8f2">{</span>
		<span style="color: #f8f8f2">LOG(</span><span style="color: #e6db74">&quot;Can&#39;t push, object isn&#39;t pushable...&quot;</span><span style="color: #f8f8f2">)</span>
		<span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span>
	<span style="color: #f8f8f2">}</span>
	
	<span style="color: #75715e">// Can push...</span>
	<span style="color: #f8f8f2">bIsPushing</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">true</span><span style="color: #f8f8f2">;</span>

	<span style="color: #f8f8f2">LOG(</span><span style="color: #e6db74">&quot;Start push!&quot;</span><span style="color: #f8f8f2">);</span>
	<span style="color: #75715e">// Move pushable away from actor</span>
	<span style="color: #f8f8f2">bLerpToLocation</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">true</span><span style="color: #f8f8f2">;</span>
	<span style="color: #f8f8f2">Cast&lt;AT7Character&gt;(GetOwner())-&gt;bLockMovement</span> <span style="color: #f8f8f2">=</span> <span style="color: #66d9ef">true</span><span style="color: #f8f8f2">;</span>

	<span style="color: #75715e">// Target location and rotation</span>
	<span style="color: #f8f8f2">TargetLocation</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">GetOwner()-&gt;GetActorLocation()</span> <span style="color: #f8f8f2">+</span> <span style="color: #f8f8f2">Pushable-&gt;BoxSide</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">PushOffset;</span>
	<span style="color: #f8f8f2">TargetRotation</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">UKismetMathLibrary::MakeRotFromX(-Pushable-&gt;BoxSide);</span>
	
	<span style="color: #75715e">// Calculate direction to pushable</span>
	<span style="color: #f8f8f2">PushableLocationOnStart</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Pushable-&gt;GetOwner()-&gt;GetActorLocation();</span>
	
	<span style="color: #75715e">// Disable physics</span>
	<span style="color: #f8f8f2">Pushable-&gt;PrimitiveComponent-&gt;SetSimulatePhysics(</span><span style="color: #66d9ef">false</span><span style="color: #f8f8f2">);</span>

	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(Pushable-&gt;DragMultiplier</span> <span style="color: #f8f8f2">!=</span> <span style="color: #ae81ff">0.f</span><span style="color: #f8f8f2">)</span>
	<span style="color: #f8f8f2">{</span>
		<span style="color: #75715e">// Raise from ground</span>
		<span style="color: #f8f8f2">Pushable-&gt;GetOwner()-&gt;AddActorWorldOffset(FVector::UpVector</span> <span style="color: #f8f8f2">*</span> <span style="color: #f8f8f2">LiftDistance);</span>
	<span style="color: #f8f8f2">}</span>
	
	<span style="color: #f8f8f2">OnStartPush.Broadcast(Pushable);</span>
<span style="color: #f8f8f2">}</span>
</pre></div>

                </div>
            </div>
            <div class="category-title-small">
                Animation
            </div>
            <p class="content-paragraph">
                <ul class="bullet-point">
                    <li class="bullet-li">
                        Using IK to place hands on object realistically. Hand spacing and offset from the objects' origin can be tweaked depending on the object
                        size and shape.
                    </li>
                    <li class="bullet-li">
                        individually rotating bones to match direction that character is trying to push at. This works for both when the character
                        is succesfully pushing or when it grabs an object but can't push it. In this last case, it will just lean towards the predicted 
                        movement direction (taken from input instead of the actual velocity).
                    </li>
                    <li>
                        Character will also "holster" gun when grabbing and move each hand to its IK target. 
                    </li>
                </ul>
            </p>
            <div class="flex-column">
                <img src="assets/img/projects/rouse/pushIK.png" alt="" class="img-wrapper" style="height: 100%;">
                <img src="assets/img/projects/rouse/leaningpushing.gif" alt="" class="img-wrapper">
                <img src="assets/img/projects/rouse/leaningstopped.gif" alt="" class="img-wrapper">
            </div>
        </div>
        <div class="project-category-wrapper">
            <div class="category-title-big" style="margin-top: 3rem;">
                Puzzle Interactions
            </div>
            <div class="content-paragraph">
                <p> 
                    The behaviour is inspired by an AND processor where all the output responses will get triggered if all buttons are pressed. The processor’s behaviour is easily customizable to work like a NAND, OR, XOR, etc.
                </p>
                <p>
                    Each button’s behaviour is very open to customization. Levers and sticky timed buttons were prototyped but didn’t make it to any puzzle in the final game.
                </p>
                <p>
                    An event is called on each response component being triggered which allows for a modular system. Multiple and diverse events can be called: Opening doors, UI prompts, particle effects, etc. These were exposed to BP and mostly worked on by designers.
                </p>
            </div>
            <div class="flex-column">
                <img src="assets/img/projects/rouse/interactables_diagram.png" alt="" class="img-wrapper">
                <img src="assets/img/projects/rouse/PuzzleInteractions.gif" alt="" class="img-wrapper">
            </div>
            <div class="expandable-button">
                <a style="display: flex; align-items: center; cursor: pointer;" onclick="OnClick(this)">
                    <div class="expandable-title">Code - Interactable Processor</div>
                    <img src="assets/icons/front-arrow-icon.png" alt="" class="expandable-arrow">
                </a>
                <div class="expandable-content" style="height: 0px;">    
                    <!-- HTML generated using hilite.me --><div class="code-snippet" style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">void</span> <span style="color: #f8f8f2">UT7InteractableProcessor::TriggerActivate()</span>
<span style="color: #f8f8f2">{</span>
	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(OutputResponses.Num()</span> <span style="color: #f8f8f2">==</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span> <span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span>
	
	<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">const</span> <span style="color: #f8f8f2">auto</span> <span style="color: #f8f8f2">Output</span> <span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">OutputResponses)</span>
	<span style="color: #f8f8f2">{</span>
		<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(Output</span> <span style="color: #f8f8f2">==</span> <span style="color: #f8f8f2">nullptr)</span> <span style="color: #66d9ef">continue</span><span style="color: #f8f8f2">;</span>
		
		<span style="color: #66d9ef">const</span> <span style="color: #f8f8f2">UT7InteractableResponse*</span> <span style="color: #f8f8f2">InteractableResp</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Output-&gt;FindComponentByClass&lt;UT7InteractableResponse&gt;();</span>
		<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(InteractableResp</span> <span style="color: #f8f8f2">==</span> <span style="color: #f8f8f2">nullptr)</span> <span style="color: #66d9ef">continue</span><span style="color: #f8f8f2">;</span>

		<span style="color: #f8f8f2">InteractableResp-&gt;OnActivate.Broadcast();</span>
	<span style="color: #f8f8f2">}</span>
<span style="color: #f8f8f2">}</span>

<span style="color: #66d9ef">void</span> <span style="color: #f8f8f2">UT7InteractableProcessor::TriggerDeactivate()</span>
<span style="color: #f8f8f2">{</span>
	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(OutputResponses.Num()</span> <span style="color: #f8f8f2">==</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span> <span style="color: #66d9ef">return</span><span style="color: #f8f8f2">;</span>
	
	<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">(</span><span style="color: #66d9ef">const</span> <span style="color: #f8f8f2">auto</span> <span style="color: #f8f8f2">Output</span> <span style="color: #f8f8f2">:</span> <span style="color: #f8f8f2">OutputResponses)</span>
	<span style="color: #f8f8f2">{</span>
		<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(Output</span> <span style="color: #f8f8f2">==</span> <span style="color: #f8f8f2">nullptr)</span> <span style="color: #66d9ef">continue</span><span style="color: #f8f8f2">;</span>
		
		<span style="color: #66d9ef">const</span> <span style="color: #f8f8f2">UT7InteractableResponse*</span> <span style="color: #f8f8f2">InteractableResp</span> <span style="color: #f8f8f2">=</span> <span style="color: #f8f8f2">Output-&gt;FindComponentByClass&lt;UT7InteractableResponse&gt;();</span>
		<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">(InteractableResp</span> <span style="color: #f8f8f2">==</span> <span style="color: #f8f8f2">nullptr)</span> <span style="color: #66d9ef">continue</span><span style="color: #f8f8f2">;</span>

		<span style="color: #f8f8f2">InteractableResp-&gt;OnDeactivate.Broadcast();</span>
	<span style="color: #f8f8f2">}</span>
<span style="color: #f8f8f2">}</span>
</pre></div>

                </div>
            </div>
        </div>
        <div class="project-category-wrapper">
            <div class="category-title-big">
                Main Takeaways
            </div>
        <ul class="bullet-point">
            <li class="bullet-li">
                Importance of QA: We didn't have a QA team working full-time on this project so we had to adapt by dedicating about an hour of playtesting every
                couple of days by the development team. This obviously took precious time away from developing that, in my opinion, ended up being spending in testing.
            </li>
            <li class="bullet-li">
                Blueprint vs C++: Due to time constraints, some of the code that was prototyped in Blueprint ended up never making it to C++. 
                This ended up causing for some bloated classes where designers struggled to navigate and prototype their mechanics. Making this switch to C++
                later in the project would've turned out to be too time consuming but I feel like if we had taken the time to gradually make this change throughout
                production, we could've saved same unnecessary headaches in the long run and provide cleaner and more understandable blueprints for the rest of the development team
                to work with.
            </li>
        </ul>
        </div>
        <div class="rights-reserved">
            © 2022 João Freire. All rights reserved. 
        </div>
    </div>
    <script>
        function OnClick(element){
            var content = element.parentElement.getElementsByClassName('expandable-content')[0];
            var arrow = element.parentElement.getElementsByClassName("expandable-arrow")[0];
            var snippet = content.getElementsByClassName("code-snippet")[0];
            if (content.style.height === "0px"){
                console.log(parseInt(snippet.clientHeight, 10));
                content.style.height = parseInt(snippet.clientHeight + 20) + "px";
                arrow.style.transform = "translateX(10px) rotate(-90deg)"
            }
            else{
                content.style.height = "0px";
                arrow.style.transform = "translateX(10px) rotate(90deg)"
            }
        }

        //Get the button:
        var button = document.getElementsByClassName("return-top")[0];
        var icon = document.getElementsByClassName("return-icon")[0];
            
        // When the user scrolls down 20px from the top of the document, show the button
        window.onscroll = function() {scrollFunction()};
            
        function scrollFunction() {
            if (document.documentElement.scrollTop > 200) {
                button.style.bottom = "20px";
            } else {
                button.style.bottom = "-50px";
            }
        }
        
        // When the user clicks on the button, scroll to the top of the document
        function topFunction() {
            document.body.scrollTop = 0; // For Safari
            document.documentElement.scrollTop = 0; // For Chrome, Firefox, IE and Opera
        }
    </script>
</body>
</html>